I"`.<p>After a long and awaited period, here we have the new Conan 1.8 release. It comes packed of new features and fixes and some great
contributions from the community. Let’s go through some of the highlights shipped in this release.</p>

<h2 id="plugins-system">Plugins system</h2>

<p>Many people were asking for a way of customizing the Conan behavior to suit their needs in order to perform tasks after some actions such as
installation of new packages, uploads to a server… We thought that the best approach for this would be to have a plugin feature in the Conan
client, so this is what we have come up with.</p>

<p>Plugins are python files with some <strong>pre</strong> and <strong>post</strong> functions that receive information through parameters and are executed right before
and after an action executed by Conan. Those actions are normally self-described by their name.</p>

<p>Here you can see a simple example of a plugin:</p>

<p><em>example_plugin.py</em></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def pre_export(output, conanfile, conanfile_path, reference, **kwargs):
     # Check basic meta-data
     for field in ["url", "license", "description"]:
         field_value = getattr(conanfile, field, None)
         if not field_value:
             output.warn("Conanfile doesn't have '%s'. "
                        "It is recommended to add it as an attribute"
                         % field)
</code></pre></div></div>

<p>Plugins can have many functions and do different things in each of them. They might also have private functions or imposts from pip
installed modules or relative ones.</p>

<p>Plugins are stored under the <em>~/.conan/plugins</em> directory that can be activated on demand using <code class="highlighter-rouge">conan config set</code> and
<code class="highlighter-rouge">conan config rm</code>.</p>

<p>There are still some things to define regarding plugins, such as the way they are installed, how they can be managed or linked to a recipe,
include new functions in the future or even change current functions signature… This is why this feature is also released as experimental
and will require more testing from the community. Feel free to report any issue or improvement in the Conan issue tracker using <code class="highlighter-rouge">[PLUGINS]</code>
in the title.</p>

<p>There is also a new repository <a href="https://github.com/conan-io/plugins">conan-io/plugins</a> where we will develop the official plugins and manage
suggestions for new ones in its own issue tracker.</p>

<h2 id="svn-support-for-scm">SVN support for SCM</h2>

<p>As said in previous releases, the SCM feature keeps improving and finally we have <a href="https://docs.conan.io/en/latest/reference/conanfile/attributes.html#scm">support for SVN</a>.</p>

<p>There has been a huge interaction with the community with <a href="https://github.com/conan-io/conan/pull/3192">more than 80 comments</a> and reviews
to develop this new feature.</p>

<p>Here you can see that it can be transparently used the same way it was done for git:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from conans import ConanFile, tools

class ConanLib(ConanFile):
    name = "lib"
    version = "0.1"
    scm = {
        "type": "svn",
        "url": "auto",
        "revision": "auto",
        "subfolder": "onesubfolder"
    }
</code></pre></div></div>

<p>There is also a new <a href="https://docs.conan.io/en/latest/reference/tools.html#tools-svn">SVN tool wrapper</a> that can be used inside your recipes
for any purpose you want.</p>

<p>Keep in mind that the this feature is still experimental as other SCM types might be added eventually that can change the interface.
However, we encourage SVN users to try this feature and report new issues or suggest improvements using <code class="highlighter-rouge">[SVN]</code> in the issue title.</p>

<h2 id="new-conventions-for-recipes">New conventions for recipes</h2>

<h3 id="protected-conanfile-members">Protected ConanFile members</h3>

<p>We have seen a great evolution of recipes being created and with the development of new features we think there is a need for a naming
convention for the <code class="highlighter-rouge">ConanFile</code> attributes and methods to avoid any future collision.</p>

<p>From now on, we encourage users to use protected members in their recipes in case they want to use custom attributes:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class MyConanFile(ConanFile):
    name = "myconan"
    version = "1.0.0"
    _custom_attribute = "some_value"  # user protected attribute

    def _custom_method(self):
         self.output.info(_custom_attribute)
</code></pre></div></div>

<p>A note has been included in the <a href="https://docs.conan.io/en/latest/reference/conanfile.html">reference section</a> to make users aware of this
new convention.</p>

<h3 id="raising-conaninvalidconfiguration">Raising <code class="highlighter-rouge">ConanInvalidConfiguration</code></h3>

<p>There were some points in the Conan documentation where we encouraged to raise exceptions in <code class="highlighter-rouge">configure()</code> for configurations not
supported in a library.</p>

<p>We have introduced a special exception called
<a href="https://docs.conan.io/en/latest/reference/conanfile/methods.html#invalid-configuration"><code class="highlighter-rouge">ConanInvalidConfiguration</code></a> for this purpose that
has different treatment on the return codes of the Conan client. This way exceptions of this type could be interpreted as a different error
by tools like <code class="highlighter-rouge">ConanPackageTools</code> (WIP).</p>

<p>Here you can see an example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from conans import ConanFile
from conans.errors import ConanInvalidConfiguration

class MyConan(ConanFile):
    name = "myconan"
    version = "0.1.3"
    settings = "os", "compiler", "arch", "build_type"

    def configure(self):
        if self.settings.os != "Windows":
            raise ConanInvalidConfiguration("Library only supports Windows")
</code></pre></div></div>

<h3 id="default-options-as-a-dictionary">Default options as a dictionary</h3>

<p>The syntax for default options and its inferred types have always been tricky, so we have done some work to document the behavior of the
<a href="https://docs.conan.io/en/latest/reference/conanfile/attributes.html#options">option values comparison</a>.</p>

<p>There is still room for improvement but is not easy to come up with a solution without breaking existing recipes. So, in order to clear the
path for future development, the recommended way to declare default options is using a dictionary in <em>conanfile.py</em>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class MyPkg(ConanFile):
    ...
    requires = "OtherPkg/0.1@user/channel"
    options = {"shared": [True, False],
               "option1": ["value1", "value2"],
               "option2": "ANY"}
    default_options = {"shared": True,
                       "option1": "value1",
                       "option2": 42,
                       "OtherPkg:shared": True}
</code></pre></div></div>

<h2 id="build-helpers-with-fixed-installation-directories">Build helpers with fixed installation directories</h2>

<p>Following the issues reported from some users using SUSE and similar Linux distributions, we realized that the installation directories in
the <code class="highlighter-rouge">AutoToolsBuildEnvironment</code> build helper was dependent on the platform, mainly using <em>lib64</em> folder instead of <em>lib</em> folder.</p>

<p>This was breaking recipes rebuilt from sources, as the default library directory declared in <code class="highlighter-rouge">self.cpp_info.libdirs</code> for consumers is
always <em>lib</em>.</p>

<p>The build helpers can’t generate a different directory structure depending on where is it executed, so we have fixed these output
directories to the most common default ones for both CMake (see
<a href="https://docs.conan.io/en/latest/reference/build_helpers/cmake.html#definitions">installation definitions</a>) and AutoTools (see
<a href="https://docs.conan.io/en/latest/reference/build_helpers/autotools.html#configure">configure()</a>) build helpers. There is also a flag
<code class="highlighter-rouge">use_default_install_dirs</code> in <code class="highlighter-rouge">AutoToolsBuildEnvironment</code> to skip this behavior.</p>

<p>You will find a warning regarding this change in the AutoTools reference section with a clear <a href="https://docs.conan.io/en/latest/reference/build_helpers/autotools.html#autotools-lib64-warning">explanation of the issue</a>.</p>

<h2 id="new-generator-b2">New generator: B2</h2>

<p>This release brings a new generator for B2, also known as Boost Build. This generator comes with full-fledged features such as the use of
subprojects and targets. It enhances the capabilities and deprecates the
<a href="https://docs.conan.io/en/latest/reference/generators/boost_build.html"><code class="highlighter-rouge">boost-build</code> generator</a>.</p>

<p>You have more information about it in the documentation reference: https://docs.conan.io/en/latest/reference/generators/b2.html</p>

<h2 id="tools-and-output">Tools and output</h2>

<p>There are new tools and improvements available in this release too:</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">tools.replace_path_in_file()</code>: New tool to replace a path in a file with another string. In Windows, it will match the path even if
the casing and the path separator doesn’t match.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">tools.collect_libs()</code> now searches for libraries in <code class="highlighter-rouge">self.cpp_info.libdirs</code>.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">tools.vcvars()</code> has been enhanced to avoid hitting issues with max size of environment variables and it can also be used with
<code class="highlighter-rouge">clang-cl</code>.</p>
  </li>
</ul>

<p>Finally, there has been some changes in the output:</p>

<ul>
  <li>
    <p>Now, every time a <code class="highlighter-rouge">conan install</code> is issued, the configuration of the profile is printed in the output. Note that this configuration
resembles the profile used for the installation and not strictly the final values applied to the package.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ conan install .
Configuration:
  [settings]
  os=Windows
  os_build=Windows
  arch=x86_64
  arch_build=x86_64
  compiler=Visual Studio
  compiler.version=15
  build_type=Release
  [options]
  [build_requires]
  [env]

PROJECT: Installing /home/user/repos/conan-box2d/conanfile.py
...
</code></pre></div>    </div>
  </li>
  <li>
    <p>Following the roadmap of deprecating Python 2, there is a new warning for Python 2 users recommending the migration to Python 3.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ conan create . conan/stable

Python 2 will soon be deprecated. It is strongly recommended to use Python 3 with Conan:
https://docs.conan.io/en/latest/installation.html#python-2-deprecation-notice

Exporting package recipe
box2d/2.3.1@conan/stable export: Copied 1 '.txt' file: CMakeLists.txt
...
</code></pre></div>    </div>
  </li>
</ul>

<p>If you want to know more about the changes in this release, check the full list of features and fixes in the
<a href="https://docs.conan.io/en/latest/changelog.html">changelog</a> (it includes links to the related Pull Request) and don’t forget to <a href="https://conan.io/downloads.html">update</a>!</p>
:ET